<!-- Loading hidden modal -->
{% include 'twig__flavorModal_view.html' %}<!-- Loading hidden modal -->



<!--BUILDER DIV-->
<div id="builderDiv" >
    {#
     # If pizza is not null, then we are editing a pizza.
     # Showing the name of what we're editing...
     #}

    {% if pizza is not null %}
        <div id="editingFlavorDiv" class="row">
            <div id="editing" class="col-lg-12">
                <h1>Editing <em>{{pizza.name}}</em></h1>
                
            </div>  
            {# Hidden pizza object #}
            <input type="hidden" name="pizza" value="{{pizza.__toString()}}">
        </div>
    {% endif %}
    <!-- SIZE ROW -->
    <div class="row">              
        <!-- SIZE COLUMN -->
        <div id="sizeColumn" class="col-lg-12">            
            <h2 class="alert alert-warning">
                Pizza size:
                <span>
                    {% if pizza is not null %}
                        {{pizza.getSize().getName()|capitalize}}
                    {% endif %}
                </span>
                <i class="glyphicon glyphicon-minus-sign pull-right" title="Show/Hide Sizes"></i>
            </h2>

            <div class="cardDivWrapper" style="display: block">
                {% set selected = false %}
                {% for size in pizzaBuilder.getSizes %}
                    {% if pizza is not null %}
                        {% if size.getId() == pizza.getSize().getId() %}
                            {% set selected = true %}
                        {% endif %}
                    {% endif %}

                    
                    {% include 'twig__card_view.html' 
                    with {'type' : 'size', 'object' : size,'selected':selected} %}
                    {% set selected = false %}
                {% endfor %}
            </div>
        </div><!-- SIZE COLUMN -->
    </div><!-- SIZE ROW -->


    <!-- CRUST ROW -->
    <div class="row">
        <!-- CRUST COLUMN -->
        <div id="crustColumn" class="col-lg-12">
            <h2 class="alert alert-warning">
                Crust type:
                <span>
                    {% if pizza is not null %}
                        {{pizza.getCrust().getName()|capitalize}}
                    {% endif %}
                </span>
                <i class="glyphicon glyphicon-plus-sign pull-right" title="Show/Hide Crusts"></i>
            </h2>

            <div class="cardDivWrapper">
                {% for crust in pizzaBuilder.getCrusts %}
                    {% if pizza is not null %}
                        {% if crust.getId() == pizza.getCrust().getId() %}
                            {% set selected = true %}
                        {% endif %}
                    {% endif %}
                    {% include 'twig__card_view.html' 
                    with {'type' : 'crust', 'object' : crust, 'selected':selected} 
                    %}
                    {% set selected = false %}
                {% endfor %}
            </div>

        </div><!-- CRUST COLUMN -->
    </div><!-- CRUST ROW -->

    <!-- EDGE ROW -->
    <div class="row">
        <!-- EDGE COLUMN -->
        <div id="edgeColumn" class="col-lg-12">
            <h2 class="alert alert-warning">
                Edge:
                <span>
                    {% if pizza is not null %}
                        {{pizza.getEdge().getName()|capitalize}}
                    {% endif %}
                </span>
                <i class="glyphicon glyphicon-plus-sign pull-right" title="Show/Hide Edges"></i>
            </h2>
            <div class="cardDivWrapper">
                {% for edge in pizzaBuilder.getEdges %}
                    {% if pizza is not null %}
                        {% if edge.getId() == pizza.getEdge().getId() %}
                            {% set selected = true %}
                        {% endif %}
                    {% endif %}
                    {% include 'twig__card_view.html' 
                        with {'type' : 'edge', 'object' : edge,'selected':selected} %}
                    {% set selected = false %}
                {% endfor %}
            </div>
        </div><!-- EDGE COLUMN -->
    </div><!-- EDGE ROW -->

    <!-- LAYOUT ROW -->
    <div class="row">
        <!-- LAYOUT COLUMN -->
        <div id="layoutColumn" class="col-lg-12">
            <h2 class="alert alert-warning">
                Layout:
                <span>
                    {% if pizza is not null %}
                        {{pizza.getLayout().getName()|capitalize}}
                    {% endif %}
                </span>
                <i class="glyphicon glyphicon-plus-sign pull-right" title="Show/Hide Layouts"></i>
            </h2>
            <div class="cardDivWrapper">
                {% for layout in pizzaBuilder.getLayouts %}
                    {% if pizza is not null %}
                        {% if layout.getId() == pizza.getLayout().getId() %}
                            {% set selected = true %}
                        {% endif %}
                    {% endif %}
                    {% include 'twig__card_view.html' 
                        with {'type' : 'layout', 'object' : layout,'selected':selected} %}
                    {% set selected = false %}

                {% endfor %}
            </div>
        </div><!-- LAYOUT COLUMN -->
    </div><!-- LAYOUT ROW -->

    <!-- FLAVOR ROW -->
    <div class="row">
        <!-- FLAVOR COLUMN -->
        <div id="flavorColumn" class="col-lg-12">
            <h2 class="alert alert-warning">
                Toppings:
                <span>
                    {# Toppings names in case we're opening a pizza to edit #}
                    {% if pizza is not null %}
                        {% if pizza.getFlavor1 is not null %}
                            {{pizza.getFlavor1.getName()|capitalize}}
                        {% endif %}

                        {% if pizza.getFlavor2 is not null %}
                            , {{pizza.getFlavor2.getName()|capitalize}}
                        {% endif %}

                        {% if pizza.getFlavor3 is not null %}
                            , {{pizza.getFlavor3.getName()|capitalize}}
                        {% endif %}

                        {% if pizza.getFlavor4 is not null %}
                            , {{pizza.getFlavor4.getName()|capitalize}}
                        {% endif %}

                    {% else %}    
                        <small>(select a layout)</small>
                    {% endif %}
                </span>
                <i class="glyphicon glyphicon-plus-sign pull-right" title="Show/Hide Layouts"></i>
            </h2> 

            <div class="cardDivWrapper">
                {% set flavor1 = null %}
                {% set flavor2 = null %}
                {% set flavor3 = null %}
                {% set flavor4 = null %}
                
                {% if pizza is not null %}
                    {% set flavor1 = pizza.getFlavor1() %}
                    {% set flavor2 = pizza.getFlavor2() %}
                    {% set flavor3 = pizza.getFlavor3() %}
                    {% set flavor4 = pizza.getFlavor4() %}                    
                {% endif %}         
                

                {% include 'twig__card_view.html' with {'number': '1','object':flavor1} %}   
                {% include 'twig__card_view.html' with {'number': '2','object':flavor2} %}            
                {% include 'twig__card_view.html' with {'number': '3','object':flavor3} %}            
                {% include 'twig__card_view.html' with {'number': '4','object':flavor4} %}   
            </div>            
        </div><!-- FLAVOR COLUMN -->
    </div><!-- FLAVOR ROW -->

    <!-- OBS ROW -->
    <div class="row">
        <!-- OBS COLUMN -->
        <div id="obsColumn" class="col-lg-12">
            <h2 class="alert alert-warning">
                Additional Info
                <i class="glyphicon glyphicon-plus-sign pull-right" title="Show/Hide Layouts"></i>
            </h2> 
            <div class="cardDivWrapper">
                <div class="obsTextArea">
                    <textarea class="form-control" rows="6"></textarea>
                </div>
            </div>
        </div><!-- OBS COLUMN -->
    </div><!-- OBS ROW -->
    <br>
    <hr>

    <form id="pizzaBuilderForm" name="pizzaBuilderForm" action="/PizzaBuilder/pizzaBuilder" method="post">
        <input type="hidden" name="userPizza" value="">        
        <input type="hidden" name="{{tokenName}}" value="{{tokenHash}}">
    </form>

    <button type="button" class="btn btn-danger btn-lg">
        Add to Cart
        <i class="glyphicon glyphicon-shopping-cart"></i>
    </button>

    <!-- form -->

    <!-- form -->
</div><!--BUILDER DIV-->

